# AUV Dynamics Modeling and Control

This repository contains the code for modeling the dynamics of an Autonomous Underwater Vehicle (**AUV**) and implementing various control strategies, including model-based (PID, LQR) and data-driven methods (**SINDy** and **DMDC**).

---

## üöÄ Getting Started

The typical workflow for this project involves data generation, model training, and finally, running the simulation with different controllers. The following sections are arranged in the recommended order of execution.

---

## üõ†Ô∏è Project Structure and File Descriptions

### 1. Configuration and Utility Files

| File | Description |
| :--- | :--- |
| `parameters.yaml` | This file contains all the **parameters and coefficients** required for the AUV's dynamic model and control laws. **This should be reviewed first.** |
| `utils.py` | Contains **helper functions** and necessary configuration variables. If you need to change the **reference trajectory** (the line the AUV should follow), it can be modified in this file. |

### 2. Data Generation

| File | Description |
| :--- | :--- |
| `generate_data.py` | This script is used to **create the input forces** data, which is a sum of sine waves. This data excites the AUV dynamics for model training. |
| `simulate_custom.py` | Takes the force data generated by `generate_data.py` and runs the AUV dynamics model. It outputs the full **dataset** of **applied forces** and corresponding **body-frame velocities** needed for training the DMDC and SINDy models. |

### 3. Modeling and Training

| File | Description |
| :--- | :--- |
| `finite_differences.py` | Contains a function to compute the **numerical differentiation** of the dataset (e.g., to find accelerations from velocities). This is a necessary step used by the SINDy training script. |
| `sindy_train.py` | This script takes the generated dataset as input to train the **Sparse Identification of Nonlinear Dynamics (SINDy)** model. It **saves the final model** and the data's **scaling factors** (mean and variance) for later use. |
| `DMDC.py` | This script runs the **Dynamic Mode Decomposition with Control (DMDC)** on the generated dataset. Its goal is to compute the constant **state matrices $A$ and $B$** that form the linear dynamic representation $\dot{x} \approx Ax + Bu$. |

### 4. Dynamics and Control

| File | Description |
| :--- | :--- |
| `VehicleDynamics.py` | Defines the **dynamics of the AUV**, including the equations of motion and an **integration method** to calculate the final states (position, velocity, etc.) at each time instant. It uses the coefficients from `parameters.yaml`. |
| `Controller.py` | This file implements **four different control options**: |
| | - **PID** (Call with: `PID.compute_force`) |
| | - **LQR** (Call with: `LQR.compute_lqr_force`) |
| | - **SINDy-based LQR** (Call with: `LQR.compute_force_sindy`) |
| | - **DMDC-based LQR** (Call with: `LQR.compute_force_dmdc`) |

### 5. Execution and Testing

| File | Description |
| :--- | :--- |
| `run.py` | The main execution script. It loads the necessary components, runs the **entire simulation** using one of the controllers from `Controller.py`, and **plots the final results**. |
| `compare_sindy_vs_normal.py` | A utility script to **compare** the performance and prediction accuracy of the **SINDy** model against a reference (or 'normal') dynamics model. |
| `sindy_dmd_test.py` | Script to test the trained SINDy and DMDC models on a separate test dataset. |
| `sindy_predict.py` | Script to check how well the trained SINDy model can predict the AUV's motion. |
| `sindy_test.py` | Another utility script for testing the SINDy model's performance. |
